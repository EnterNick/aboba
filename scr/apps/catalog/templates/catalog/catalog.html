{% extends 'base.html' %}
{% load rest_framework %}
{% load static %}

{% block content %}

<div class="products">
    <button class="form__btn">–§–∏–ª—å—Ç—Ä—ã</button>  
    <form class="form">
        {% csrf_token %}
        <div class="products__filters">
            <div class="form" style="padding-left: 27px;">
                <span class="products__filters-close">x</span>
                <fieldset>
                    <div class="form-group">
                        <label for="price_min">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label>
                        <input type="number" id="price_min" name="price_min" value="{{ filter_data.price_min }}">
                    </div>
                    <div class="form-group">
                        <label for="price_max">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label>
                        <input type="number" name="price_max" id="price_max" value="{{ filter_data.price_max }}">
                    </div>
                    <div class="form-group">
                        <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                        <select name="category" id="category">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            {% for i in filter.category.choices.items %}
                                <option {% if filter_data.category == i.0 %} selected {% endif %} value="{{i.0}}">{{i.1}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                </fieldset>
            </div>
        </div>
        <input type="search" name="search" value="{{ filter_data.search }}">
        <button type="submit">–ò—Å–∫–∞—Ç—å</button>
        <select name="ordering" id="ordering" onchange="document.querySelector('.form').submit()">
            <option value="">ü†ïü†ó</option>
            {% for i in filter.ordering.choices.items %}
                <option {% if filter_data.ordering == i.0 %} selected {% endif %} value="{{i.0}}">{{i.1}}</option>
            {% endfor %}
        </select>
    </form>

    <h1 class="products__title">–¢–æ–≤–∞—Ä—ã</h1>
    
    <div class="products__wrapper">
        {% if data.results %}
            {% for product in data.results %}
                <a class="products__product" href="{% url 'good' product.id %}">
                    <div class="products__product__header">
                        <img class="products__product__image" src="{{ product.image }}" alt="{{ product.title }}">
                        <h2 class="products__product__title">{{ product.title }}</h2>
                    </div>
                    <div class="products__product__body">
                        <p class="products__product__description">{{ product.description }}</p>
                        <p class="products__product__price">
                            –¶–µ–Ω–∞: <span class="products__product__price-value">{{ product.price }} —Ä—É–±.</span>
                        </p>
                        <p class="products__product__quantity">–û—Å—Ç–∞–ª–æ—Å—å: {{ product.value }}</p>
                        <p class="products__product__category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ product.category }}</p>
                        <p class="products__product__orders">–ó–∞–∫–∞–∑–æ–≤: {{ product.orders }}</p>
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <p class="products__no-results">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
        {% endif %}
    </div>
</div>

<div class="pagination">
    <div class="step-links">
        {% if data.previous != null %}
            <a class="pagination__link" href="?page=1">&laquo; –ü–µ—Ä–≤–∞—è</a>
            <a class="pagination__link" href="{{ data.previous }}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
        {% endif %}

        {% if data.next != null %}
            <a class="pagination__link" href="{{ data.next }}">–°–ª–µ–¥—É—é—â–∞—è</a>
            <a class="pagination__link" href="{{ data.next }}">–ü–æ—Å–ª–µ–¥–Ω—è—è &raquo;</a>
        {% endif %}
    </div>
</div>

<script src="{% static 'js/catalog.js' %}">
</script>
{% endblock %}
